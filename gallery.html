<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Template Gallery - Spreadsheet</title>
    <link rel="icon" href="favicon.png" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="gallery.css">
</head>

<body>
    <div class="gallery-container">
        <!-- Header -->
        <header class="gallery-header">
            <div class="gallery-header-left">
                <h1><i class="fa-solid fa-table-cells"></i> Spreadsheet</h1>
            </div>
            <div class="gallery-header-right">
                <a href="index.html" class="header-btn" title="Create blank spreadsheet">
                    <i class="fa-solid fa-plus"></i>
                    <span>New Sheet</span>
                </a>
                <button id="theme-toggle" type="button" class="header-btn icon-only" title="Toggle dark/light mode">
                    <i class="fa-solid fa-sun icon-light"></i>
                    <i class="fa-solid fa-moon icon-dark"></i>
                </button>
                <a href="https://github.com/supunlakmal/spreadsheet" target="_blank" rel="noopener noreferrer"
                    class="header-btn icon-only" title="View on GitHub">
                    <i class="fa-brands fa-github"></i>
                </a>
            </div>
        </header>

        <!-- Main Content -->
        <main class="gallery-main">
            <div class="gallery-intro">
                <h2><i class="fa-solid fa-shapes"></i> Template Gallery</h2>
                <p>Choose a template to get started quickly. Click any template to open it in the spreadsheet.</p>
            </div>

            <div id="template-grid" class="template-grid">
                <!-- Templates will be rendered here by JavaScript -->
            </div>
        </main>

        <!-- Footer -->
        <footer class="gallery-footer">
            <p>Data is stored in the URL - no server required. Share your spreadsheet by sharing the link.</p>
        </footer>
    </div>

    <script>
        // Theme management
        function initTheme() {
            const savedTheme = localStorage.getItem("spreadsheet-theme");
            if (savedTheme === "dark") {
                document.body.classList.add("dark-mode");
            }
        }

        function toggleTheme() {
            document.body.classList.toggle("dark-mode");
            const isDark = document.body.classList.contains("dark-mode");
            localStorage.setItem("spreadsheet-theme", isDark ? "dark" : "light");
        }

        // Render template cards
        function renderTemplates(templates) {
            const grid = document.getElementById("template-grid");
            if (!grid) return;

            grid.innerHTML = templates.map(template => `
                <a href="${template.link}" class="template-card">
                    <div class="template-icon">
                        <i class="fa-solid ${template.icon}"></i>
                    </div>
                    <h3 class="template-title">${template.name}</h3>
                    <p class="template-description">${template.description}</p>
                    <span class="template-cta">
                        Use Template <i class="fa-solid fa-arrow-right"></i>
                    </span>
                </a>
            `).join("");
        }

        // Load templates from JSON file
        async function loadTemplates() {
            const grid = document.getElementById("template-grid");
            try {
                const response = await fetch("templates.json");
                if (!response.ok) throw new Error("Failed to load templates.json");
                const templates = await response.json();
                renderTemplates(templates);
            } catch (error) {
                console.error("Error loading templates:", error);
                if (grid) {
                    grid.innerHTML = '<p style="color: var(--text-muted); text-align: center;">Failed to load templates. Please refresh the page.</p>';
                }
            }
        }

        // Initialize
        function init() {
            initTheme();
            loadTemplates();

            // Theme toggle
            const themeToggle = document.getElementById("theme-toggle");
            if (themeToggle) {
                themeToggle.addEventListener("click", toggleTheme);
            }
        }

        // Run when DOM is ready
        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", init);
        } else {
            init();
        }
    </script>
</body>

</html>
